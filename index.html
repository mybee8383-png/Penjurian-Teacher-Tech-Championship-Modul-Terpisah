<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Teacher Tech Championship • Beranda</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-blue-100 text-slate-800">
  <header class="max-w-6xl mx-auto px-6 pt-6 flex items-center gap-3">
    <img src="logo-ttc.png" alt="Teacher Tech Championship" class="h-12 w-auto" />
    <h1 class="text-2xl md:text-3xl font-bold text-slate-900">Teacher Tech Championship</h1>
  </header>

  <section class="max-w-6xl mx-auto p-6">
    <div class="rounded-2xl bg-white/80 backdrop-blur border border-slate-200 shadow-sm p-6 md:p-8">
      <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-6">
        <div class="flex-1">
          <div class="inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-medium mb-3" id="pillStatus">
            <span class="w-2 h-2 rounded-full bg-rose-500" id="dotStatus"></span>
            <span id="labelStatus" class="text-rose-700">Konfigurasi belum dibuat</span>
          </div>
          <h2 class="text-3xl font-bold">Panel Beranda</h2>
          <p class="text-slate-600 mt-2">Kelola data lomba, lakukan penjurian, dan lihat rekap per wilayah — semuanya dari satu tempat.</p>
        </div>

        <!-- Ringkasan -->
        <div class="min-w-[280px] grow md:max-w-sm">
          <div class="grid grid-cols-2 gap-3">
            <div class="rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-xs text-slate-500">Sekolah</div>
              <div class="mt-1 text-2xl font-bold" id="statSekolah">—</div>
            </div>
            <div class="rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-xs text-slate-500">Aspek</div>
              <div class="mt-1 text-2xl font-bold" id="statAspek">—</div>
            </div>
            <div class="rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-xs text-slate-500">Total Juri</div>
              <div class="mt-1 text-2xl font-bold" id="statJuri">—</div>
            </div>
            <div class="rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-xs text-slate-500">Juri Mengisi</div>
              <div class="mt-1 text-2xl font-bold" id="statJuriIsi">0</div>
            </div>
          </div>

          <!-- Progress -->
          <div class="mt-4">
            <div class="flex items-center justify-between text-xs text-slate-600 mb-1">
              <span>Progress Penjurian (berdasarkan jumlah juri)</span>
              <span id="labelProgress">0%</span>
            </div>
            <div class="h-2 w-full rounded-full bg-slate-200 overflow-hidden">
              <div id="barProgress" class="h-full bg-indigo-600 rounded-full" style="width:0%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Info navigasi tanpa tombol -->
    <div class="mt-8 rounded-2xl bg-white/80 backdrop-blur border border-slate-200 p-6">
      <h3 class="font-semibold">Cara pakai singkat</h3>
      <ol class="list-decimal pl-5 mt-2 text-slate-600 space-y-1 text-sm">
        <li>Buka <code>/data.html</code> untuk menyiapkan daftar sekolah, aspek &amp; bobot, serta nama juri.</li>
        <li>Para juri buka <code>/juri.html</code> untuk memberi nilai.</li>
        <li>Buka <code>/hasil.html</code> untuk melihat peringkat per wilayah.</li>
      </ol>
    </div>

    <!-- Tombol reset di bawah -->
    <div class="mt-10 flex justify-center">
      <button id="btnResetAll" class="text-base rounded-md border border-rose-300 text-rose-700 bg-white hover:bg-rose-50 px-5 py-3">
        Reset Semua Data
      </button>
    </div>
  </section>

  <footer class="max-w-6xl mx-auto px-6 pb-10 text-xs text-slate-500">
    © Teacher Tech Championship • Aplikasi penjurian sederhana (client-side)
  </footer>

  <script>
    const $ = (s) => document.querySelector(s);
    function getConfig(){ try { return JSON.parse(localStorage.getItem('TTC_config')||'null'); } catch { return null; } }
    function getJudgesWithScores(){ const a=[]; for(let i=0;i<localStorage.length;i++){ const k=localStorage.key(i); if(k.startsWith('TTC_scores_')) a.push(k.slice(11)); } return a; }

    function setStatus(){
      const cfg = getConfig();
      const filled = getJudgesWithScores();
      const has = !!cfg;

      $('#labelStatus').textContent = has ? 'Konfigurasi tersimpan' : 'Konfigurasi belum dibuat';
      $('#labelStatus').className = has ? 'text-emerald-700' : 'text-rose-700';
      $('#dotStatus').className = 'w-2 h-2 rounded-full ' + (has ? 'bg-emerald-500':'bg-rose-500');
      const pill = document.getElementById('pillStatus');
      pill.className = 'inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-medium mb-3 ' + (has ? 'bg-emerald-50':'bg-rose-50');

      $('#statSekolah').textContent = cfg?.sekolahs?.length ?? '—';
      $('#statAspek').textContent   = cfg?.aspek?.length ?? '—';
      $('#statJuri').textContent    = cfg?.judges?.length ?? '—';
      $('#statJuriIsi').textContent = filled.length;

      const pct = (cfg?.judges?.length) ? Math.round((filled.length / cfg.judges.length) * 100) : 0;
      $('#labelProgress').textContent = pct + '%';
      $('#barProgress').style.width = pct + '%';
    }
    setStatus();

    document.getElementById('btnResetAll').onclick = () => {
      if(!confirm('Hapus SEMUA data (konfigurasi + seluruh nilai juri)?')) return;
      Object.keys(localStorage).forEach(k=>{ if(k.startsWith('TTC_')) localStorage.removeItem(k); });
      setStatus();
      alert('Semua data dihapus. Mulai lagi dari /data.html');
    };
  </script>
</body>
</html>
